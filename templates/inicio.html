<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAEC - Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>
    <div class="dashboard-container">
        <!-- Logo flotante (esquina superior izquierda) -->
        <div class="floating-logo">
            <img src="{{ url_for('static', filename='img/logocaec.png') }}" alt="Logo CAEC">
        </div>

        <!-- √Årea de usuario flotante (esquina superior derecha) -->
        <div class="floating-user-area">
            <!-- Campana de notificaciones -->
            <div class="notification-bell" onclick="toggleNotifications()">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
                <span class="notification-badge">3</span>
                <div class="notification-dropdown" id="notificationDropdown">
                    <div class="notification-header">Notificaciones</div>
                    <div class="notification-item">
                        <div class="notification-icon">üíß</div>
                        <div class="notification-content">
                            <div class="notification-title">Nivel de agua bajo</div>
                            <div class="notification-time">Hace 5 minutos</div>
                        </div>
                    </div>
                    <div class="notification-item">
                        <div class="notification-icon">üå°Ô∏è</div>
                        <div class="notification-content">
                            <div class="notification-title">Temperatura √≥ptima</div>
                            <div class="notification-time">Hace 1 hora</div>
                        </div>
                    </div>
                    <div class="notification-item">
                        <div class="notification-icon">üåæ</div>
                        <div class="notification-content">
                            <div class="notification-title">Cosecha pr√≥xima en 5 d√≠as</div>
                            <div class="notification-time">Hace 3 horas</div>
                        </div>
                    </div>
                    <div class="notification-footer">Ver todas las notificaciones</div>
                </div>
            </div>

            <!-- Men√∫ de usuario -->
            <div class="user-menu-container" onclick="toggleProfileMenu()">
                <div class="user-circle">
                    <span class="user-initial">{{ user_name[0] if user_name else 'U' }}</span>
                </div>
                <div class="user-dropdown" id="profileDropdown">
                    <div class="user-dropdown-header">
                        <div class="user-avatar-large">{{ user_name[0] if user_name else 'U' }}</div>
                        <div class="user-info">
                            <div class="user-name">{{ user_name if user_name else 'Usuario' }}</div>
                        </div>
                    </div>
                    <div class="dropdown-divider"></div>
                    <a href="{{ url_for('account') }}" class="dropdown-item">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                        Mi Cuenta
                    </a>
                    <a href="{{ url_for('systems') }}" class="dropdown-item">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"></rect>
                            <rect x="14" y="3" width="7" height="7"></rect>
                            <rect x="14" y="14" width="7" height="7"></rect>
                            <rect x="3" y="14" width="7" height="7"></rect>
                        </svg>
                        Sistemas CAEC
                    </a>
                    <a href="{{ url_for('config') }}" class="dropdown-item">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path d="M12 1v6m0 6v6m9.66-9.66l-4.24 4.24m-6.84 0l-4.24-4.24M1 12h6m6 0h6"></path>
                        </svg>
                        Configuraci√≥n
                    </a>
                    <div class="dropdown-divider"></div>
                    <a href="{{ url_for('login') }}" class="dropdown-item logout">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                            <polyline points="16 17 21 12 16 7"></polyline>
                            <line x1="21" y1="12" x2="9" y2="12"></line>
                        </svg>
                        Cerrar Sesi√≥n
                    </a>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="dashboard-main">
            <h2>Panel de Control Sistema CAEC</h2>

            <!-- Visualizaci√≥n Resumen del Sistema CAEC -->
            <div class="system-overview">
                <svg class="caec-system-diagram" viewBox="0 0 1200 1350" xmlns="http://www.w3.org/2000/svg">
                    <!-- Definiciones -->
                    <defs>
                        <!-- Gradiente para el agua oscura subiendo -->
                        <linearGradient id="waterGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#0d47a1;stop-opacity:0.95" />
                            <stop offset="100%" style="stop-color:#1565c0;stop-opacity:0.9" />
                        </linearGradient>

                        <!-- Gradiente para contenedores transparentes -->
                        <linearGradient id="containerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#e8f4f8;stop-opacity:0.7" />
                            <stop offset="50%" style="stop-color:#ffffff;stop-opacity:0.9" />
                            <stop offset="100%" style="stop-color:#e8f4f8;stop-opacity:0.7" />
                        </linearGradient>
                        <!-- Gradiente animado para el agua que sube -->
                        <linearGradient id="risingWaterGradient" x1="0" x2="0" y1="1" y2="0">
                            <stop offset="0" stop-color="#1565c0">
                                <animate attributeName="offset" from="0" to="1" dur="2.5s" repeatCount="indefinite" />
                            </stop>
                            <stop offset="0" stop-color="#64b5f6">
                                <animate attributeName="offset" from="0.05" to="1.05" dur="2.5s" repeatCount="indefinite" />
                            </stop>
                            <stop offset="0" stop-color="#1565c0">
                                <animate attributeName="offset" from="0.1" to="1.1" dur="2.5s" repeatCount="indefinite" />
                            </stop>
                        </linearGradient>
                    </defs>

                    <!-- Torre Hidrop√≥nica Vertical -->
                    <g id="tower">
                        <!-- Tapa superior circular -->
                        <ellipse cx="600" cy="70" rx="65" ry="20" fill="#b0bec5" stroke="#78909c" stroke-width="2"/>
                        <circle cx="600" cy="60" r="8" fill="#90a4ae"/>

                        <!-- Tuber√≠a Central (oculta por defecto, solo visible cuando irrigaci√≥n activa) -->
                        <g id="centralPipe" style="display: none;">
                            <rect x="588" y="70" width="24" height="730" fill="#263238" stroke="#37474f" stroke-width="2" rx="3"/>
                        </g>

                        <!-- 5 Niveles de contenedores sin separaci√≥n -->
                        <!-- Nivel 1 -->
                        <g id="level1">
                            <rect x="450" y="90" width="300" height="140" fill="url(#containerGradient)" stroke="#b0bec5" stroke-width="2.5" rx="8" opacity="0.85"/>
                            <line x1="450" y1="160" x2="750" y2="160" stroke="#cfd8dc" stroke-width="1.5" opacity="0.5"/>
                            <!-- Plantas centradas y m√°s abajo -->
                            <circle cx="510" cy="145" r="30" fill="#66bb6a" opacity="0.95"/>
                            <circle cx="495" cy="132" r="23" fill="#81c784" opacity="0.9"/>
                            <circle cx="525" cy="132" r="23" fill="#81c784" opacity="0.9"/>

                            <circle cx="690" cy="145" r="30" fill="#66bb6a" opacity="0.95"/>
                            <circle cx="675" cy="132" r="23" fill="#81c784" opacity="0.9"/>
                            <circle cx="705" cy="132" r="23" fill="#81c784" opacity="0.9"/>

                            <!-- Gotas de agua (ocultas por defecto) -->
                            <g class="water-drops level1-drops" style="display: none;">
                                <circle cx="480" cy="165" r="3" fill="#1976d2" opacity="0.8" class="drop drop1">
                                    <animate attributeName="cy" from="165" to="225" dur="1s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" from="0.8" to="0" dur="1s" repeatCount="indefinite"/>
                                </circle>
                                <circle cx="520" cy="170" r="3" fill="#1976d2" opacity="0.8" class="drop drop2">
                                    <animate attributeName="cy" from="170" to="230" dur="1.2s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" from="0.8" to="0" dur="1.2s" repeatCount="indefinite"/>
                                </circle>
                                <circle cx="680" cy="168" r="3" fill="#1976d2" opacity="0.8" class="drop drop3">
                                    <animate attributeName="cy" from="168" to="228" dur="1.1s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" from="0.8" to="0" dur="1.1s" repeatCount="indefinite"/>
                                </circle>
                                <circle cx="720" cy="172" r="3" fill="#1976d2" opacity="0.8" class="drop drop4">
                                    <animate attributeName="cy" from="172" to="232" dur="0.9s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" from="0.8" to="0" dur="0.9s" repeatCount="indefinite"/>
                                </circle>
                            </g>
                        </g>

                        <!-- Nivel 2 -->
                        <g id="level2">
                            <rect x="450" y="230" width="300" height="140" fill="url(#containerGradient)" stroke="#b0bec5" stroke-width="2.5" rx="8" opacity="0.85"/>
                            <line x1="450" y1="300" x2="750" y2="300" stroke="#cfd8dc" stroke-width="1.5" opacity="0.5"/>
                            <circle cx="510" cy="285" r="30" fill="#66bb6a" opacity="0.95"/>
                            <circle cx="495" cy="272" r="23" fill="#81c784" opacity="0.9"/>
                            <circle cx="525" cy="272" r="23" fill="#81c784" opacity="0.9"/>

                            <circle cx="690" cy="285" r="30" fill="#66bb6a" opacity="0.95"/>
                            <circle cx="675" cy="272" r="23" fill="#81c784" opacity="0.9"/>
                            <circle cx="705" cy="272" r="23" fill="#81c784" opacity="0.9"/>

                            <g class="water-drops level2-drops" style="display: none;">
                                <circle cx="480" cy="305" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="305" to="365" dur="1s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1s" repeatCount="indefinite"/></circle>
                                <circle cx="520" cy="310" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="310" to="370" dur="1.2s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1.2s" repeatCount="indefinite"/></circle>
                                <circle cx="680" cy="308" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="308" to="368" dur="1.1s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1.1s" repeatCount="indefinite"/></circle>
                                <circle cx="720" cy="312" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="312" to="372" dur="0.9s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="0.9s" repeatCount="indefinite"/></circle>
                            </g>
                        </g>

                        <!-- Nivel 3 -->
                        <g id="level3">
                            <rect x="450" y="370" width="300" height="140" fill="url(#containerGradient)" stroke="#b0bec5" stroke-width="2.5" rx="8" opacity="0.85"/>
                            <line x1="450" y1="440" x2="750" y2="440" stroke="#cfd8dc" stroke-width="1.5" opacity="0.5"/>
                            <circle cx="510" cy="425" r="30" fill="#66bb6a" opacity="0.95"/>
                            <circle cx="495" cy="412" r="23" fill="#81c784" opacity="0.9"/>
                            <circle cx="525" cy="412" r="23" fill="#81c784" opacity="0.9"/>

                            <circle cx="690" cy="425" r="30" fill="#66bb6a" opacity="0.95"/>
                            <circle cx="675" cy="412" r="23" fill="#81c784" opacity="0.9"/>
                            <circle cx="705" cy="412" r="23" fill="#81c784" opacity="0.9"/>

                            <g class="water-drops level3-drops" style="display: none;">
                                <circle cx="480" cy="445" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="445" to="505" dur="1s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1s" repeatCount="indefinite"/></circle>
                                <circle cx="520" cy="450" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="450" to="510" dur="1.2s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1.2s" repeatCount="indefinite"/></circle>
                                <circle cx="680" cy="448" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="448" to="508" dur="1.1s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1.1s" repeatCount="indefinite"/></circle>
                                <circle cx="720" cy="452" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="452" to="512" dur="0.9s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="0.9s" repeatCount="indefinite"/></circle>
                            </g>
                        </g>

                        <!-- Nivel 4 -->
                        <g id="level4">
                            <rect x="450" y="510" width="300" height="140" fill="url(#containerGradient)" stroke="#b0bec5" stroke-width="2.5" rx="8" opacity="0.85"/>
                            <line x1="450" y1="580" x2="750" y2="580" stroke="#cfd8dc" stroke-width="1.5" opacity="0.5"/>
                            <circle cx="510" cy="565" r="30" fill="#66bb6a" opacity="0.95"/>
                            <circle cx="495" cy="552" r="23" fill="#81c784" opacity="0.9"/>
                            <circle cx="525" cy="552" r="23" fill="#81c784" opacity="0.9"/>

                            <circle cx="690" cy="565" r="30" fill="#66bb6a" opacity="0.95"/>
                            <circle cx="675" cy="552" r="23" fill="#81c784" opacity="0.9"/>
                            <circle cx="705" cy="552" r="23" fill="#81c784" opacity="0.9"/>

                            <g class="water-drops level4-drops" style="display: none;">
                                <circle cx="480" cy="585" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="585" to="645" dur="1s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1s" repeatCount="indefinite"/></circle>
                                <circle cx="520" cy="590" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="590" to="650" dur="1.2s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1.2s" repeatCount="indefinite"/></circle>
                                <circle cx="680" cy="588" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="588" to="648" dur="1.1s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1.1s" repeatCount="indefinite"/></circle>
                                <circle cx="720" cy="592" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="592" to="652" dur="0.9s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="0.9s" repeatCount="indefinite"/></circle>
                            </g>
                        </g>

                        <!-- Nivel 5 -->
                        <g id="level5">
                            <rect x="450" y="650" width="300" height="140" fill="url(#containerGradient)" stroke="#b0bec5" stroke-width="2.5" rx="8" opacity="0.85"/>
                            <line x1="450" y1="720" x2="750" y2="720" stroke="#cfd8dc" stroke-width="1.5" opacity="0.5"/>
                            <circle cx="510" cy="705" r="30" fill="#66bb6a" opacity="0.95"/>
                            <circle cx="495" cy="692" r="23" fill="#81c784" opacity="0.9"/>
                            <circle cx="525" cy="692" r="23" fill="#81c784" opacity="0.9"/>

                            <circle cx="690" cy="705" r="30" fill="#66bb6a" opacity="0.95"/>
                            <circle cx="675" cy="692" r="23" fill="#81c784" opacity="0.9"/>
                            <circle cx="705" cy="692" r="23" fill="#81c784" opacity="0.9"/>

                            <g class="water-drops level5-drops" style="display: none;">
                                <circle cx="480" cy="725" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="725" to="785" dur="1s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1s" repeatCount="indefinite"/></circle>
                                <circle cx="520" cy="730" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="730" to="790" dur="1.2s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1.2s" repeatCount="indefinite"/></circle>
                                <circle cx="680" cy="728" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="728" to="788" dur="1.1s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="1.1s" repeatCount="indefinite"/></circle>
                                <circle cx="720" cy="732" r="3" fill="#1976d2" opacity="0.8"><animate attributeName="cy" from="732" to="792" dur="0.9s" repeatCount="indefinite"/><animate attributeName="opacity" from="0.8" to="0" dur="0.9s" repeatCount="indefinite"/></circle>
                            </g>
                        </g>

                        <!-- Columna de agua subiendo (ahora con gradiente) -->
                        <g id="irrigationColumn" style="display: none;">
                            <rect x="590" y="70" width="20" height="720" fill="url(#risingWaterGradient)" />
                        </g>
                    </g>

                    <!-- Tapa del Tanque -->
                    <rect x="395" y="785" width="410" height="10" fill="#5d4037" rx="3"/>

                    <!-- Tanque de Agua conectado directamente -->
                    <g id="waterTank">
                        <!-- Contenedor principal del tanque -->
                        <rect x="400" y="790" width="400" height="340" fill="#ffffff" stroke="#1976d2" stroke-width="5" rx="12"/>

                        <!-- Nivel de agua dentro del tanque (se actualizar√° din√°micamente) -->
                        <rect id="tankWaterLevel" x="405" y="880" width="390" height="245" fill="#64b5f6" rx="8"/>

                        <!-- Clip para las olas -->
                        <clipPath id="tankClip">
                            <rect x="400" y="790" width="400" height="340" rx="12"/>
                        </clipPath>

                        <!-- Olas animadas -->
                        <g clip-path="url(#tankClip)">
                            <g id="waterWaves" class="system-waves">
                                <ellipse class="system-wave system-wave1" cx="600" cy="875" rx="200" ry="25" fill="rgba(255, 255, 255, 0.4)"/>
                                <ellipse class="system-wave system-wave2" cx="600" cy="881" rx="200" ry="25" fill="rgba(255, 255, 255, 0.3)"/>
                                <ellipse class="system-wave system-wave3" cx="600" cy="887" rx="200" ry="25" fill="rgba(255, 255, 255, 0.2)"/>
                            </g>
                        </g>

                        <!-- Bomba (oculta por defecto, solo visible cuando irrigaci√≥n activa) -->
                        <g id="pump" style="display: none;">
                            <!-- Tubo de conexi√≥n (fondo) -->
                            <rect x="590" y="800" width="20" height="250" fill="#263238" />
                            <!-- Agua animada dentro del tubo de conexi√≥n -->
                            <rect x="590" y="800" width="20" height="250" fill="url(#risingWaterGradient)" />
                            <!-- Cuerpo de la bomba -->
                            <rect x="560" y="1050" width="80" height="60" fill="#37474f" stroke="#263238" stroke-width="3" rx="6"/>
                            <circle cx="600" cy="1080" r="22" fill="#546e7a" stroke="#263238" stroke-width="2"/>
                        </g>
                    </g>

                    <!-- Indicadores Externos con m√°s espacio -->
                    <g id="waterLevelIndicator">
                        <line x1="830" y1="950" x2="930" y2="950" stroke="#1976d2" stroke-width="3"/>
                        <circle cx="830" cy="950" r="7" fill="#1976d2"/>
                        <text x="945" y="945" font-size="18" fill="#1a1a1a" font-weight="600">Nivel de Agua</text>
                        <text id="waterLevelText" x="945" y="975" font-size="34" fill="#1976d2" font-weight="bold">75%</text>
                    </g>

                    <g id="phIndicator">
                        <line x1="370" y1="950" x2="270" y2="950" stroke="#ec407a" stroke-width="3"/>
                        <circle cx="370" cy="950" r="7" fill="#ec407a"/>
                        <text x="255" y="945" text-anchor="end" font-size="18" fill="#1a1a1a" font-weight="600">Nivel pH</text>
                        <text id="phValueText" x="255" y="975" text-anchor="end" font-size="34" fill="#ec407a" font-weight="bold">6.5</text>
                    </g>

                    <g id="nutrientIndicator">
                        <line x1="600" y1="1150" x2="600" y2="1220" stroke="#ab47bc" stroke-width="3"/>
                        <circle cx="600" cy="1150" r="7" fill="#ab47bc"/>
                        <text x="600" y="1255" text-anchor="middle" font-size="18" fill="#1a1a1a" font-weight="600">Nutrientes</text>
                        <text id="nutrientValueText" x="600" y="1285" text-anchor="middle" font-size="34" fill="#ab47bc" font-weight="bold">85%</text>
                    </g>
                </svg>
            </div>

            <!-- Monitoring Grid with Interactive Cards -->
            <div class="sensors-grid">
                <!-- Contenedor Tarjeta Nivel de Agua -->
                <div class="card-wrapper">
                    <button class="sensor-card water-card" data-sensor="water" onclick="openSensorModal('water')">
                        <div class="card-icon">üíß</div>
                        <h3 class="card-title">Nivel de Agua</h3>
                        <div class="card-value">
                            <span class="value-number" id="waterValue">75</span>
                            <span class="value-unit">%</span>
                        </div>
                        <div class="wave-container">
                            <div class="wave wave1"></div>
                            <div class="wave wave2"></div>
                            <div class="wave wave3"></div>
                        </div>
                    </button>
                </div>

                <!-- Contenedor Tarjeta pH -->
                <div class="card-wrapper">
                    <button class="sensor-card ph-card" data-sensor="ph" onclick="openSensorModal('ph')">
                        <div class="card-icon">üß™</div>
                        <h3 class="card-title">Nivel pH</h3>
                        <div class="card-value">
                            <span class="value-number" id="phValue">6.5</span>
                            <span class="value-unit">pH</span>
                        </div>
                    </button>
                </div>

                <!-- Contenedor Tarjeta Irrigaci√≥n -->
                <div class="card-wrapper">
                    <button class="sensor-card irrigation-card" data-sensor="irrigation" onclick="openSensorModal('irrigation')">
                        <!-- Animaci√≥n SVG de irrigaci√≥n -->
                        <div class="card-icon" style="height: 90px; display: flex; align-items: center; justify-content: center; margin-bottom: 0.5rem;">
                            <svg viewBox="0 0 200 120" style="width: 130px; height: auto;">
                                <!-- Tubo horizontal -->
                                <rect x="20" y="15" width="160" height="12" fill="#546e7a" rx="6"/>

                                <!-- Conexiones verticales -->
                                <rect x="50" y="27" width="4" height="20" fill="#546e7a"/>
                                <rect x="100" y="27" width="4" height="20" fill="#546e7a"/>
                                <rect x="150" y="27" width="4" height="20" fill="#546e7a"/>

                                <!-- Boquillas -->
                                <circle cx="52" cy="50" r="5" fill="#37474f"/>
                                <circle cx="102" cy="50" r="5" fill="#37474f"/>
                                <circle cx="152" cy="50" r="5" fill="#37474f"/>

                                <!-- Gotas de agua (animadas cuando activo) -->
                                <g id="irrigationCardDrops" class="irrigation-card-drops">
                                    <circle cx="52" cy="60" r="3" fill="#1976d2" opacity="0.8">
                                        <animate attributeName="cy" from="60" to="100" dur="1.5s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.8" to="0" dur="1.5s" repeatCount="indefinite"/>
                                    </circle>
                                    <circle cx="102" cy="65" r="3" fill="#1976d2" opacity="0.8">
                                        <animate attributeName="cy" from="65" to="105" dur="1.3s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.8" to="0" dur="1.3s" repeatCount="indefinite"/>
                                    </circle>
                                    <circle cx="152" cy="62" r="3" fill="#1976d2" opacity="0.8">
                                        <animate attributeName="cy" from="62" to="102" dur="1.4s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.8" to="0" dur="1.4s" repeatCount="indefinite"/>
                                    </circle>
                                    <circle cx="52" cy="70" r="2.5" fill="#42a5f5" opacity="0.6">
                                        <animate attributeName="cy" from="70" to="105" dur="1.2s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.6" to="0" dur="1.2s" repeatCount="indefinite"/>
                                    </circle>
                                    <circle cx="102" cy="68" r="2.5" fill="#42a5f5" opacity="0.6">
                                        <animate attributeName="cy" from="68" to="103" dur="1.6s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.6" to="0" dur="1.6s" repeatCount="indefinite"/>
                                    </circle>
                                    <circle cx="152" cy="72" r="2.5" fill="#42a5f5" opacity="0.6">
                                        <animate attributeName="cy" from="72" to="107" dur="1.1s" repeatCount="indefinite"/>
                                        <animate attributeName="opacity" from="0.6" to="0" dur="1.1s" repeatCount="indefinite"/>
                                    </circle>
                                </g>
                            </svg>
                        </div>
                        <h3 class="card-title">Irrigaci√≥n</h3>
                        <div class="card-value" onclick="toggleIrrigationState(event)" style="cursor: pointer;">
                            <span class="value-text" id="irrigationValue">Activo</span>
                        </div>
                    </button>
                </div>

                <!-- Contenedor Tarjeta Temperatura -->
                <div class="card-wrapper">
                    <button class="sensor-card temperature-card" data-sensor="temperature" onclick="openSensorModal('temperature')">
                        <div class="card-icon">üå°Ô∏è</div>
                        <h3 class="card-title">Temperatura</h3>
                        <div class="card-value">
                            <span class="value-number" id="tempValue">22</span>
                            <span class="value-unit">¬∞C</span>
                        </div>
                    </button>
                </div>

                <!-- Contenedor Tarjeta Nutrientes -->
                <div class="card-wrapper">
                    <button class="sensor-card nutrient-card" data-sensor="nutrient" onclick="openSensorModal('nutrient')">
                        <div class="card-icon">‚öóÔ∏è</div>
                        <h3 class="card-title">Nutrientes</h3>
                        <div class="card-value">
                            <span class="value-number" id="nutrientValue">85</span>
                            <span class="value-unit">%</span>
                        </div>
                    </button>
                </div>

                <!-- Contenedor Tarjeta Pr√≥xima Cosecha -->
                <div class="card-wrapper">
                    <button class="sensor-card harvest-card" data-sensor="harvest" onclick="openHarvestModal('harvest')">
                        <div class="card-icon">üåæ</div>
                        <h3 class="card-title">Pr√≥xima Cosecha</h3>
                        <div class="card-value harvest-value">
                            <span class="value-number" id="days">00</span>
                            <span class="value-unit">D√≠as</span>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Modal para mostrar detalles del sensor -->
            <div id="sensorModal" class="modal" onclick="closeModalOnOutsideClick(event)">
                <div class="modal-content" onclick="event.stopPropagation()">
                    <h2 id="modalTitle">Sensor</h2>

                    <!-- Contenedor de visualizaci√≥n (se cargar√° din√°micamente) -->
                    <div id="visualizationContainer">
                        <!-- Aqu√≠ se insertar√° la visualizaci√≥n espec√≠fica -->
                    </div>

                    <!-- Detalles adicionales -->
                    <div class="modal-details" id="modalDetails">
                        <!-- Los detalles se cargar√°n din√°micamente -->
                    </div>
                </div>
            </div>

            <!-- Modal para la tarjeta de cosecha -->
            <div id="harvestModal" class="modal" onclick="closeModalOnOutsideClick(event)">
                <div class="modal-content" onclick="event.stopPropagation()">
                    <span class="close-btn" onclick="closeHarvestModal()">&times;</span>
                    <h2 id="harvestModalTitle">Detalles de la Cosecha</h2>
            
                    <div class="harvest-progress-container">
                        <svg class="harvest-progress-circle" viewBox="0 0 120 120">
                            <circle class="progress-bg" cx="60" cy="60" r="54" />
                            <circle class="progress-bar" id="harvestProgressBar" cx="60" cy="60" r="54" />
                        </svg>
                        <div class="progress-text">
                            <span id="harvestProgressPercentage">0%</span>
                        </div>
                    </div>
            
                    <div class="harvest-details">
                        <div class="detail-row">
                            <span class="detail-label">Tipo de Cultivo:</span>
                            <span class="detail-value" id="harvestCropType">Lechuga</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Fecha de Plantaci√≥n:</span>
                            <span class="detail-value" id="harvestPlantDate">--/--/----</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Fecha Estimada de Cosecha:</span>
                            <span class="detail-value" id="harvestEstimatedDate">--/--/----</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>
